<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Login</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header><h1>ADMIN LOGIN</h1></header>
  <div class="card" style="max-width: 500px; margin: 50px auto; padding: 40px;">
    <input type="text" id="u" placeholder="Username" style="width:100%; padding:15px; margin:10px 0; font-size:1.2rem;"><br>
    <input type="password" id="p" placeholder="Password" style="width:100%; padding:15px; margin:10px 0; font-size:1.2rem;"><br>
    <button onclick="login()" style="width:100%; padding:20px; font-size:1.5rem;">LOGIN →</button>
    <p id="msg" class="error" style="margin-top:20px; font-size:1.2rem;"></p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/main.js"></script>
  <script>
    async function login() {
      const username = document.getElementById('u').value.trim();
      const password = document.getElementById('p').value;
      const msg = document.getElementById('msg');
      msg.innerText = '';

      if (!username || !password) {
        msg.innerText = '⚠️ Enter both username and password!';
        return;
      }

      // Correct hash for password "Nepal@2025Election"
      const correctHash = 'd0870c3283bfe1930d656ec12f0c71719612399b14b45b0cc398d84f13d8a1e3';

      const encoder = new TextEncoder();
      const data = encoder.encode(password);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashHex = Array.from(new Uint8Array(hashBuffer))
        .map(b => b.toString(16).padStart(2, '0'))
        .join('');

      if (username === 'superadmin2025' && hashHex === correctHash) {
        localStorage.setItem('admin', 'true');
        location.href = 'admin-dashboard.html';
      } else {
        msg.innerText = '❌ Wrong username or password! Try again.';
      }
    }
  </script>
</body>
</html>
